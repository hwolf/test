name: 'Deploy Pull Request'

on:
  issue_comment:
    types:
     - created

jobs:
  build:
    name: 'Build Pull Request'
    if: github.event.issue.pull_request && contains(github.event.comment.body, '@deploy')
    uses: hwolf/test/.github/workflows/build-and-test.yml@test-1
    with:
      ref: ${{ steps.branch.outputs.head_ref }}

  deploy:
    name: 'Deploy Pull Request'
    needs: build
    uses: hwolf/test/.github/workflows/deploy.yml@test-1
    with:
      image-name: "${{ needs.build.outputs.image-name }}"
      environment: DEV
      ref: ${{ steps.branch.outputs.head_ref }}

name: "Deploy to PRD"
on:
  workflow_dispatch:

jobs:
  revision:
    name: 'Revision'
    runs-on: ubuntu-latest
    steps:
      - run: |
          echo "revision=${GITHUB_REF#"refs/tags/qa-deployed-"}" >> $GITHUB_ENV

  dump:
    name: "Dump"
    needs:
      - revision
    runs-on: ubuntu-latest
    steps:
      - run: echo "XXX $revision"
      - run: echo "XXX ${{ needs.revision.outputs.revision }}"
      - run: echo "XXX ${{ toJson(env) }}"

  deploy-prod:
    name: "Deploy to PRD"
    needs:
      - revision
    uses: hwolf/workflows/.github/workflows/deploy.yml@main
    with:
      revision: "${{ needs.revision.outputs.revision }}"
      environment: "prd"
